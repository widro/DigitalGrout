(function($) {
	var $slider = $('#slider');
	if ($slider.length){
		var $carousel = $('#carousel', $slider),
			$controls = $('#carousel-controls [data-animate-to]', $slider),			
			updateNav = function(){
				try{
					$controls.removeClass('active');
					$($controls[ $carousel.roundabout('getChildInFocus') ]).addClass('active');
				} catch(e){}
			},
			autoplay = true;
			
		$carousel.roundabout({
			childSelector: 'figure.slide',
			minOpacity: 1,
			autoplay: autoplay,
			autoplayDuration: 5000,
			autoplayPauseOnHover: true,
			responsive: true
		}).on('animationStart', function(){
			var $this = $(this);
			autoplay && $this.roundabout("stopAutoplay");			
		}).on('animationEnd', function(){
			var $this = $(this);
			autoplay && $this.roundabout("startAutoplay", updateNav);			
			updateNav();
		});
		$controls.on('click dbclick', function(){
			var $this = $(this), data = $this.data();
			if (typeof data.animateTo == 'number'){
				var slideNum = parseInt(data.animateTo);
				$carousel.roundabout('animateToChild', slideNum, updateNav);
			}
		});
	}
	
	
	// fix accordion heading state
	$('.accordion-heading').each(function(){
		var $this = $(this), $body = $this.siblings('.accordion-body');
		if (!$body.hasClass('in')){
			$this.find('.accordion-toggle').addClass('collapsed');
		}
	});
	
	$('#faq').collapse().on('show', function(el){
		var $body = $(el.target);
	}).on('hide', function(el){
		var $body = $(el.target), $heading = $body.siblings('.accordion-heading');
		$heading.find('.accordion-toggle').addClass('collapsed');
	});
	
	// twice click
	$(document).on('click.twice', '.open [data-toggle="dropdown"]', function(e){
		var $this = $(this), href = $this.attr('href');
		e.preventDefault();
		window.location.href = href;
		return false;
	});
	
}(jQuery));
	
	
	
	
	